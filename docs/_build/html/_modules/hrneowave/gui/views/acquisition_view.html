

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hrneowave.gui.views.acquisition_view &mdash; Documentation CHNeoWave 1.0.0</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=05dadb3a"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            CHNeoWave
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Référence API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/core.html">Module Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/gui.html">Module GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/data.html">Module Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/utils.html">Module Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">CHNeoWave</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Code du module</a></li>
          <li class="breadcrumb-item"><a href="../views.html">hrneowave.gui.views</a></li>
      <li class="breadcrumb-item active">hrneowave.gui.views.acquisition_view</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Code source de hrneowave.gui.views.acquisition_view</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Vue d&#39;acquisition CHNeoWave</span>
<span class="sd">Étape 3 : Acquisition des données</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PySide6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span>
    <span class="n">QSplitter</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QTextEdit</span><span class="p">,</span> <span class="n">QTableWidget</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">,</span>
    <span class="n">QGroupBox</span><span class="p">,</span> <span class="n">QProgressBar</span><span class="p">,</span> <span class="n">QSpinBox</span><span class="p">,</span> <span class="n">QDoubleSpinBox</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QComboBox</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PySide6.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">Slot</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QTimer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PySide6.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFont</span><span class="p">,</span> <span class="n">QColor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Utilisation de l&#39;adaptateur matplotlib pour compatibilité PySide6</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..components.matplotlib_adapter</span><span class="w"> </span><span class="kn">import</span> <span class="n">pg</span>

<div class="viewcode-block" id="AcquisitionView">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AcquisitionView</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Vue d&#39;acquisition des données</span>
<span class="sd">    Respecte le principe d&#39;isolation : UNIQUEMENT l&#39;acquisition</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Signal émis lorsque la session d&#39;acquisition est terminée</span>
    <span class="n">acquisitionFinished</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    
<div class="viewcode-block" id="AcquisitionView.__init__">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupTimers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectSignals</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="AcquisitionView.setupUI">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.setupUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setupUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configuration de l&#39;interface utilisateur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Layout principal</span>
        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        
        <span class="c1"># Titre principal</span>
        <span class="n">title_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Étape 3 : Acquisition des Données&quot;</span><span class="p">)</span>
        <span class="n">title_font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
        <span class="n">title_font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">title_font</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">title_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">title_font</span><span class="p">)</span>
        <span class="n">title_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #2980b9; margin-bottom: 10px;&quot;</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">title_label</span><span class="p">)</span>
        
        <span class="c1"># Splitter principal pour les graphiques</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_splitter</span> <span class="o">=</span> <span class="n">QSplitter</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>
        
        <span class="c1"># Zone des graphiques (côté gauche)</span>
        <span class="n">graphs_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">graphs_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">graphs_widget</span><span class="p">)</span>
        <span class="n">graphs_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Splitter vertical pour les 3 graphiques</span>
        <span class="n">graphs_splitter</span> <span class="o">=</span> <span class="n">QSplitter</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">)</span>
        
        <span class="c1"># Graphique 1 : Séries temporelles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;Amplitude (mm)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;Temps (s)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Séries Temporelles&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">graphs_splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="p">)</span>
        
        <span class="c1"># Graphique 2 : Spectres de fréquence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;Fréquence (Hz)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Spectres de Fréquence&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">graphs_splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="p">)</span>
        
        <span class="c1"># Graphique 3 : Analyse en temps réel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">PlotWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;Hauteur (mm)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;Temps (s)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Acquisition en Temps Réel&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">graphs_splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="p">)</span>
        
        <span class="n">graphs_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">graphs_splitter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">graphs_widget</span><span class="p">)</span>
        
        <span class="c1"># Zone des docks (côté droit)</span>
        <span class="n">docks_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">docks_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">docks_widget</span><span class="p">)</span>
        <span class="n">docks_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Dock 1 : Infos Essai</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTrialInfoDock</span><span class="p">(</span><span class="n">docks_layout</span><span class="p">)</span>
        
        <span class="c1"># Dock 2 : État Capteurs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createSensorStatusDock</span><span class="p">(</span><span class="n">docks_layout</span><span class="p">)</span>
        
        <span class="c1"># Panneau de contrôle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createControlPanel</span><span class="p">(</span><span class="n">docks_layout</span><span class="p">)</span>
        
        <span class="n">docks_widget</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">docks_widget</span><span class="p">)</span>
        
        <span class="c1"># Configuration du splitter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_splitter</span><span class="o">.</span><span class="n">setSizes</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">350</span><span class="p">])</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_splitter</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.createTrialInfoDock">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.createTrialInfoDock">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">createTrialInfoDock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Création du dock d&#39;informations d&#39;essai</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Informations Essai&quot;</span><span class="p">)</span>
        <span class="n">info_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">info_group</span><span class="p">)</span>
        
        <span class="c1"># Informations de base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span> <span class="o">=</span> <span class="n">QTextEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span>
            <span class="s2">&quot;Projet: Projet Test</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Date: &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Capteurs: 4 actifs</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Fréquence: 100 Hz</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Durée prévue: 300 s&quot;</span>
        <span class="p">)</span>
        <span class="n">info_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span><span class="p">)</span>
        
        <span class="c1"># Barre de progression</span>
        <span class="n">progress_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Progression:&quot;</span><span class="p">)</span>
        <span class="n">info_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">progress_label</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span> <span class="o">=</span> <span class="n">QProgressBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">info_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span><span class="p">)</span>
        
        <span class="c1"># Temps écoulé</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elapsed_time_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Temps écoulé: 00:00:00&quot;</span><span class="p">)</span>
        <span class="n">info_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elapsed_time_label</span><span class="p">)</span>
        
        <span class="n">parent_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">info_group</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.createSensorStatusDock">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.createSensorStatusDock">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">createSensorStatusDock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Création du dock d&#39;état des capteurs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;État des Capteurs&quot;</span><span class="p">)</span>
        <span class="n">sensor_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_group</span><span class="p">)</span>
        
        <span class="c1"># Tableau des capteurs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s2">&quot;Capteur&quot;</span><span class="p">,</span> <span class="s2">&quot;État&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
        
        <span class="c1"># Remplissage du tableau</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="c1"># Nom du capteur</span>
            <span class="n">sensor_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Capteur </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">sensor_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sensor_item</span><span class="p">)</span>
            
            <span class="c1"># État du capteur</span>
            <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;Prêt&quot;</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>  <span class="c1"># Vert léger</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>
        
        <span class="c1"># Ajustement des colonnes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="n">sensor_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="p">)</span>
        
        <span class="c1"># Statistiques en temps réel</span>
        <span class="n">stats_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Statistiques:&quot;</span><span class="p">)</span>
        <span class="n">sensor_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">stats_label</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span> <span class="o">=</span> <span class="n">QTextEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span>
            <span class="s2">&quot;Points acquis: 0</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Fréquence réelle: 0.0 Hz</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Amplitude max: 0.0 mm&quot;</span>
        <span class="p">)</span>
        <span class="n">sensor_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="p">)</span>
        
        <span class="n">parent_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_group</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.reset_view">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.reset_view">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Réinitialise la vue pour un nouveau projet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resetAcquisition</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="AcquisitionView.set_calibration_data">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.set_calibration_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_calibration_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibration_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configure la vue avec les données de calibration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Mise à jour des informations d&#39;essai avec les données de calibration</span>
        <span class="n">sensor_count</span> <span class="o">=</span> <span class="n">calibration_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sensor_count&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">info_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Projet: </span><span class="si">{</span><span class="n">calibration_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;project_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Projet Test&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Date: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Capteurs: </span><span class="si">{</span><span class="n">sensor_count</span><span class="si">}</span><span class="s2"> actifs</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Fréquence: 100 Hz</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Durée prévue: 300 s&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trial_info_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">info_text</span><span class="p">)</span>
        
        <span class="c1"># Mise à jour du tableau des capteurs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="n">sensor_count</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sensor_count</span><span class="p">):</span>
            <span class="c1"># Nom du capteur</span>
            <span class="n">sensor_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Capteur </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">sensor_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sensor_item</span><span class="p">)</span>
            
            <span class="c1"># État du capteur</span>
            <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;Prêt&quot;</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>  <span class="c1"># Vert léger</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>
        
        <span class="c1"># Ajustement des colonnes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        
        <span class="c1"># Mise à jour des données de simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sensor_count</span><span class="p">)]</span></div>

    
<div class="viewcode-block" id="AcquisitionView.get_acquisition_data">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.get_acquisition_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_acquisition_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retourne les données d&#39;acquisition pour le workflow</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">,</span>
            <span class="s1">&#39;sample_rate&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
            <span class="s1">&#39;sensor_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">),</span>
            <span class="s1">&#39;time_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s1">&#39;sensor_data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">],</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
            <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;acquiring&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="k">else</span> <span class="s1">&#39;completed&#39;</span>
        <span class="p">}</span></div>

    
<div class="viewcode-block" id="AcquisitionView.createControlPanel">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.createControlPanel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">createControlPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Création du panneau de contrôle minimaliste</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Contrôle d&#39;Acquisition&quot;</span><span class="p">)</span>
        <span class="n">control_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">control_group</span><span class="p">)</span>
        
        <span class="c1"># Boutons de contrôle</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        
        <span class="c1"># Bouton Démarrer/Arrêter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Démarrer Acquisition&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                background-color: #27ae60;</span>
<span class="s2">                color: white;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 8px;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">                font-size: 11pt;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: #229954;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="p">)</span>
        
        <span class="c1"># Bouton Pause Affichage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Pause Affichage&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                background-color: #f39c12;</span>
<span class="s2">                color: white;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 6px;</span>
<span class="s2">                font-size: 10pt;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: #e67e22;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:disabled {</span>
<span class="s2">                background-color: #95a5a6;</span>
<span class="s2">                color: #34495e;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="p">)</span>

        <span class="c1"># Bouton Terminer Acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Terminer et Analyser&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                background-color: #3498db;</span>
<span class="s2">                color: white;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 8px;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">                font-size: 11pt;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: #2980b9;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:disabled {</span>
<span class="s2">                background-color: #bdc3c7;</span>
<span class="s2">                color: #7f8c8d;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="p">)</span>
        
        <span class="n">control_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
        
        <span class="c1"># Espacement</span>
        <span class="n">control_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="n">parent_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">control_group</span><span class="p">)</span>
        <span class="n">parent_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="AcquisitionView.setupTimers">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.setupTimers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setupTimers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configuration des timers pour la simulation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Timer pour la mise à jour des données</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateData</span><span class="p">)</span>
        
        <span class="c1"># Timer pour la mise à jour de l&#39;interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateUI</span><span class="p">)</span>
        
        <span class="c1"># Données de simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="mf">0.0</span></div>

    
<div class="viewcode-block" id="AcquisitionView.connectSignals">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.connectSignals">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">connectSignals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connexion des signaux</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggleAcquisition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggleDisplayPause</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">finishAcquisition</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.toggleAcquisition">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.toggleAcquisition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggleAcquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basculement entre démarrage et arrêt de l&#39;acquisition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;toggleAcquisition called. is_acquiring: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startAcquisition</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stopAcquisition</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="AcquisitionView.startAcquisition">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.startAcquisition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">startAcquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Démarrage de l&#39;acquisition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Démarrage de l&#39;acquisition&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="c1"># Mise à jour de l&#39;interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Arrêter Acquisition&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                background-color: #e74c3c;</span>
<span class="s2">                color: white;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 8px;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">                font-size: 11pt;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: #c0392b;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


        
        <span class="c1"># Mise à jour du statut des capteurs</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;Acquisition&quot;</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">52</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>  <span class="c1"># Bleu léger</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>
        
        <span class="c1"># Démarrage des timers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># 100 Hz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>   <span class="c1"># 10 Hz pour l&#39;interface</span>
        
        <span class="c1"># Réinitialisation des données</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sensor_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">:</span>
            <span class="n">sensor_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="mf">0.0</span></div>

    
<div class="viewcode-block" id="AcquisitionView.stopAcquisition">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.stopAcquisition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stopAcquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arrêt de l&#39;acquisition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Arrêt de l&#39;acquisition&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1"># Arrêt des timers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        
        <span class="c1"># Mise à jour de l&#39;interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Démarrer Acquisition&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_stop_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                background-color: #27ae60;</span>
<span class="s2">                color: white;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 8px;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">                font-size: 11pt;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: #229954;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Pause Affichage&quot;</span><span class="p">)</span>
        
        <span class="c1"># Mise à jour du statut des capteurs</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;Arrêté&quot;</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span><span class="p">)</span>
            <span class="n">status_item</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">149</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>  <span class="c1"># Gris léger</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span></div>

        

    
<div class="viewcode-block" id="AcquisitionView.finishAcquisition">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.finishAcquisition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">finishAcquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Termine la session d&#39;acquisition et émet les données.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;finishAcquisition called.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stopAcquisition</span><span class="p">()</span>

        <span class="c1"># Préparation des données pour l&#39;émission du signal</span>
        <span class="n">session_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">,</span>
            <span class="s1">&#39;sample_rate&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
            <span class="s1">&#39;sensor_count&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;time_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s1">&#39;sensor_data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">],</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
            <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="c1"># Émission du signal vers le MainController</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Émission du signal acquisitionFinished&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisitionFinished</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">session_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="AcquisitionView.toggleDisplayPause">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.toggleDisplayPause">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggleDisplayPause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basculement de la pause d&#39;affichage</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Reprendre Affichage&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pause_display_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Pause Affichage&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.updateData">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.updateData">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour des données (simulation)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="c1"># Génération de données simulées</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 100 Hz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">)</span>
        
        <span class="c1"># Simulation de vagues avec différentes fréquences pour chaque capteur</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="c1"># Mélange de plusieurs fréquences pour simuler des vagues réalistes</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">)</span> <span class="o">*</span>  <span class="c1"># Variation lente</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># Fréquence principale</span>
                        <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.2</span> <span class="o">+</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># Harmonique</span>
                        <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span>  <span class="c1"># Bruit</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>
        
        <span class="c1"># Limitation de la taille des buffers (garder seulement les 1000 derniers points)</span>
        <span class="n">max_points</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_points</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="p">[</span><span class="o">-</span><span class="n">max_points</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">sensor_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">:</span>
                <span class="n">sensor_list</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">sensor_list</span><span class="p">[</span><span class="o">-</span><span class="n">max_points</span><span class="p">:]</span></div>

    
<div class="viewcode-block" id="AcquisitionView.updateUI">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.updateUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">updateUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour de l&#39;interface utilisateur</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="c1"># Mise à jour des graphiques</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateGraphs</span><span class="p">()</span>
        
        <span class="c1"># Mise à jour des statistiques</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatistics</span><span class="p">()</span>
        
        <span class="c1"># Mise à jour du temps écoulé</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>
            <span class="n">elapsed_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Suppression des microsecondes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elapsed_time_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temps écoulé: </span><span class="si">{</span><span class="n">elapsed_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Mise à jour de la barre de progression (simulation sur 300s)</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">/</span> <span class="mf">300.0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">progress</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="AcquisitionView.updateGraphs">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.updateGraphs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">updateGraphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour des graphiques</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span>
        
        <span class="c1"># Graphique temps réel (dernier capteur)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pen</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        
        <span class="c1"># Graphique séries temporelles (tous les capteurs)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">pen</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Capteur </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="c1"># Graphique fréquentiel (FFT du premier capteur)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>  <span class="c1"># Minimum pour une FFT significative</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateFrequencyPlot</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="AcquisitionView.updateFrequencyPlot">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.updateFrequencyPlot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">updateFrequencyPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour du graphique fréquentiel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># FFT des données du premier capteur</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">512</span><span class="p">:])</span>  <span class="c1"># Derniers 512 points</span>
            <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># dt = 0.01s</span>
            
            <span class="c1"># Garder seulement les fréquences positives</span>
            <span class="n">positive_freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">positive_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positive_freqs</span><span class="p">,</span> <span class="n">positive_fft</span><span class="p">,</span> <span class="n">pen</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># Ignorer les erreurs de FFT</span></div>

    
<div class="viewcode-block" id="AcquisitionView.updateStatistics">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.updateStatistics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">updateStatistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mise à jour des statistiques</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span>
        
        <span class="c1"># Calcul des statistiques</span>
        <span class="n">points_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="p">)</span>
        <span class="n">real_frequency</span> <span class="o">=</span> <span class="n">points_count</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">max_amplitude</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="n">data</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">)</span>
        
        <span class="n">stats_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Points acquis: </span><span class="si">{</span><span class="n">points_count</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Fréquence réelle: </span><span class="si">{</span><span class="n">real_frequency</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Hz</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Amplitude max: </span><span class="si">{</span><span class="n">max_amplitude</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> mm&quot;</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">stats_text</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.resetAcquisition">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.resetAcquisition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resetAcquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Réinitialisation de l&#39;acquisition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acquiring</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stopAcquisition</span><span class="p">()</span>
        
        <span class="c1"># Nettoyage des données</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_data</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sensor_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_data</span><span class="p">:</span>
            <span class="n">sensor_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="c1"># Nettoyage des graphiques</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realtime_plot</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="c1"># Réinitialisation de l&#39;interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elapsed_time_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Temps écoulé: 00:00:00&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats_text</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span>
            <span class="s2">&quot;Points acquis: 0</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Fréquence réelle: 0.0 Hz</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Amplitude max: 0.0 mm&quot;</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="AcquisitionView.set_controller">
<a class="viewcode-back" href="../../../../api/gui.html#hrneowave.gui.views.acquisition_view.AcquisitionView.set_controller">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Définit le contrôleur d&#39;acquisition pour cette vue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[DEBUG] Contrôleur d&#39;acquisition défini: </span><span class="si">{</span><span class="n">controller</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Connecter les signaux du contrôleur si nécessaire</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;acquisition_started&#39;</span><span class="p">):</span>
            <span class="n">controller</span><span class="o">.</span><span class="n">acquisition_started</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_controller_acquisition_started</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;acquisition_stopped&#39;</span><span class="p">):</span>
            <span class="n">controller</span><span class="o">.</span><span class="n">acquisition_stopped</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_controller_acquisition_stopped</span><span class="p">)</span></div>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_controller_acquisition_started</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gestionnaire pour le démarrage d&#39;acquisition depuis le contrôleur&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Acquisition démarrée depuis le contrôleur&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_controller_acquisition_stopped</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gestionnaire pour l&#39;arrêt d&#39;acquisition depuis le contrôleur&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Acquisition arrêtée depuis le contrôleur&quot;</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2024, Laboratoire d&#39;Études Maritimes.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>